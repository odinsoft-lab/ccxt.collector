# CCXT.Collector v2.x Release Notes

## 2.1.12 - 2026-01-12

### Added
- **Kraken Exchange Implementation**: Full WebSocket API v2 support
  - WebSocket URL: `wss://ws.kraken.com/v2` (public), `wss://ws-auth.kraken.com/v2` (private)
  - Supported channels: ticker, book (orderbook), trade
  - Symbol format: Standard format with slash (BTC/USD, ETH/USD)
  - Batch subscription support for multiple symbols
  - Incremental orderbook updates with snapshot + delta handling
  - 5/5 tests passing (connection, orderbook, trade, ticker, multiple subscriptions)

- **Bitfinex Exchange Implementation**: Full WebSocket API v2 support
  - WebSocket URL: `wss://api-pub.bitfinex.com/ws/2` (public), `wss://api.bitfinex.com/ws/2` (private)
  - Supported channels: ticker, book (orderbook), trades, candles
  - Symbol format: tBTCUSD, tETHUSD (t + BASE + QUOTE, no separator)
  - Channel ID-based message routing
  - Incremental orderbook updates with AMOUNT sign for bid/ask detection
  - 5/5 tests passing (connection, orderbook, trade, ticker, multiple subscriptions)

- **Bitstamp Exchange Implementation**: Full WebSocket API v2 support
  - WebSocket URL: `wss://ws.bitstamp.net` (public)
  - Supported channels: live_trades, order_book, diff_order_book
  - Symbol format: btcusd (lowercase, no separator)
  - Event-based message routing (bts:subscribe, trade, data)
  - Full orderbook snapshots and incremental updates
  - 5/5 tests passing (connection, orderbook, trade, ticker, multiple subscriptions)

- **MEXC Exchange Implementation**: Partial support (connection ready)
  - WebSocket URL: `wss://wbs.mexc.com/ws`
  - Symbol format: BTCUSDT (uppercase, no separator)
  - Connection and subscription mechanism implemented
  - **Note**: Data parsing requires Protocol Buffers (protobuf) support - MEXC uses `.pb` format for all market streams
  - Future work: Add Google.Protobuf package and MEXC proto definitions

- **Observability System**: Full metrics and health monitoring support
  - `IChannelObserver` interface for metrics injection
  - `ChannelStatistics` class with message count, latency, bytes received, error tracking
  - `ConnectionHealth` class with health status (Healthy/Degraded/Unhealthy)
  - `ChannelObserver` default implementation with real-time event notifications
  - `OnMetricsUpdated` and `OnHealthChanged` events for external monitoring integration
  - `RecordMessageMetrics()` helper method for exchange implementations
  - `GetConnectionHealth()` method on WebSocketClientBase

- **Dependency Injection Support**: Microsoft.Extensions.DependencyInjection integration
  - `AddCcxtCollector()` extension method for service registration
  - `AddCcxtCollector<TObserver>()` for custom observer injection
  - `AddExchangeClient<TClient>()` for individual exchange registration
  - `ExchangeClientBuilder` for fluent configuration of multiple exchanges

- **Comprehensive Test Coverage**: Increased test count from 154 to 439 tests (285% increase)
  - `ParsingHelpersTests.cs` - 78 tests for symbol/interval parsing helpers
  - `MarketTests.cs` - 18 tests for Market struct (Parse, TryParse, Equality)
  - `SubscriptionInfoTests.cs` - 10 tests for subscription management
  - `OrderBookTests.cs` - 10 tests for orderbook data structures
  - `SMATests.cs` - 10 tests for Simple Moving Average indicator
  - `EMATests.cs` - 8 tests for Exponential Moving Average indicator
  - `RSITests.cs` - 8 tests for Relative Strength Index indicator
  - `BollingerBandTests.cs` - 10 tests for Bollinger Band indicator
  - `ChannelObserverTests.cs` - 18 tests for observability classes

### Fixed
- **Build Warnings**: Resolved all compilation warnings (0 warnings, 0 errors)
  - Added `#nullable enable` to fix CS8632 warnings in test files
  - Removed unnecessary `System.Text.Encoding.CodePages` package (NU1510)

### Changed
- **Exchange Verification**: Verified all 16 active exchanges using current API versions
  - Binance, Bitfinex (V2), Bitget (V2), Bithumb, Bitstamp, Bybit (V5), Coinbase, Coinone, Crypto.com, Gate.io (V4), Huobi, Korbit (V2), Kraken (V2), Kucoin, OKX (V5), Upbit

### Removed
- **Bittrex Test File**: Removed `BittrexTests.cs` (exchange closed December 2023)

### Documentation
- Created `docs/TODO.md` with prioritized task tracking
- Updated `docs/TASK.md` with accurate implementation status

### Fixed
- **Bitget V2 API Migration**: Migrated from deprecated V1 to V2 WebSocket API
  - Changed WebSocket URL from `wss://ws.bitget.com/spot/v1/stream` to `wss://ws.bitget.com/v2/ws/public`
  - Changed private URL to `wss://ws.bitget.com/v2/ws/private`
  - Changed `instType` from `"sp"` to `"SPOT"` (uppercase required)
  - Changed ping format from JSON `{"op":"ping"}` to plain string `"ping"`
  - All 5 Bitget tests now passing (previously 2 failing due to V1 API decommission)

---

## 2.1.10 - 2025-12-15

### Added
- Added `OnInfo` event to `IWebSocketClient` interface for informational logging
- Added `OnInfo` event and `RaiseInfo()` method to `WebSocketClientBase`
- Added `RaiseInfo()` logging to `BinanceWebSocketClient.SubscribeTickerAsync()`

### Changed
- Changed info logs from `RaiseError()` to `RaiseInfo()` in Upbit/Binance exchanges
- Removed duplicate `RaiseInfo()` method in Kucoin

### Fixed
- Fixed Binance WebSocket disconnection caused by custom ping message

---

## 2.1.9 - 2025-08-14

### Changed
- GitHub organization changed from ccxt-net to odinsoft-lab
- Reorganized samples project structure for better modularity
- Split changelog into per-version files under docs/releases

### Documentation
- Consolidated release notes into v2.md
- Updated repository URLs and documentation structure

---

## 2.1.8 - 2025-08-14

### Changed
- Added System.Collections.Immutable package to fully support ImmutableList and related extension methods on netstandard2.0
- Replaced netstandard2.0-incompatible APIs (Random.Shared, DateTimeOffset.UnixEpoch, C# 8 Index/Range, HashCode.Combine) with compatible alternatives

### Fixed
- Resolved build and runtime compatibility issues for netstandard2.0/2.1 targets
- Prevented platform-specific exceptions in string parsing and hash calculation logic

### Internal
- No API signature changes; test and sample projects unaffected
- All targets (netstandard2.0, netstandard2.1, net8.0, net9.0) build and test successfully

---

## 2.1.7 - 2025-08-13

### Added
- Enhanced sample testing utilities (menu system, batch tests)
- Centralized `ExchangeParsingHelpers` for symbols/intervals
- Crypto.com full WebSocket implementation
- Individual exchange sample implementations (15 exchanges)
  - Created `IExchangeSample` interface for unified sample structure
  - Each exchange has dedicated sample file demonstrating WebSocket connectivity
  - Real-time data display with formatted output for each exchange

### Changed
- Refactored 11 exchanges to use centralized parsing
- Standardized instType/symbol formats
- Coinbase: level2→level2_batch
- **2025-08-14**: Reorganized samples project structure
  - Split monolithic Program.cs into modular components
  - Created dedicated test runners for different test scenarios
  - Improved code organization with clear separation of concerns

### Fixed
- Crypto.com: Message processing and data parsing
- Coinone: V2 API compatibility
- Coinbase: Authentication and URLs
- Bitget: InstType "sp", symbol format
- **2025-08-14**: Fixed data model property access in exchange samples
  - Corrected nested structure access (e.g., `orderbook.result?.bids`)
  - Fixed trade and ticker data property references
  - Resolved string interpolation character encoding issues

### Refactored (2025-08-14)
- **Samples Project Structure**:
  - `Models/TestResults.cs`: Dedicated test result data models
  - `Registry/ExchangeRegistry.cs`: Central exchange configuration hub
  - `Tests/ExchangeTestRunner.cs`: Basic connectivity and data reception tests
  - `Tests/MultiMarketTestRunner.cs`: Multi-market data reception testing
  - `Tests/SampleDemoRunner.cs`: Individual exchange sample demonstrations
  - `Utilities/` folder for menu system (created by Program.cs refactoring)
  - Streamlined `Program.cs` using new modular components

---

## 2.1.6 - 2025-08-12

### Added
- Unified subscription handling (`MarkSubscriptionActive`)
- Auto-resubscription on reconnect
- WebSocket test suite (15 exchanges)
- ChannelManager with batch support
- Nullable types, SourceLink, analyzers

### Fixed
- KuCoin: Complete protocol rewrite
- Korbit: V2 API implementation

### Performance
- Statistics O(n×period)→O(n) complexity
- JsonExtensions epoch handling to 2100
- LinqExtension optimizations

---

## 2.1.5 - 2025-08-11

### Highlights
- Newtonsoft.Json→System.Text.Json migration
- 20-30% faster parsing, 15-25% less memory
- Batch subscription management
- Comprehensive test framework

### Batch Subscription Support (11 exchanges)
Upbit, Bithumb, Coinbase, OKX, Korbit, Huobi, Crypto.com, Coinone, Gate.io, Binance, Bitget

---

## 2.1.4

- Sample improvements, WebSocket stability

---

## 2.1.3

- 15 exchanges complete implementation

---

## 2.1.2

- Batch callbacks (90% reduction)

---

## 2.1.1

- Dynamic buffers, exponential backoff

---

## 2.1.0

- Market struct, 40-60% symbol conversion improvement

---

## 2.0.0

- WebSocket architecture (132 exchanges)
